<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>운영실 출입관리 시스템</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --sidebar-bg-color: #1a253c;
      --main-bg-color: #f4f7fc;
      --card-bg-color: #ffffff;
      --primary-accent-color: #4a6cf7;
      --text-color-light: #f8f9fa;
      --text-color-dark: #343a40;
      --text-color-muted: #6c757d;
      --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      --card-hover-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
    }

    body {
      font-family: 'Noto Sans KR', sans-serif;
      background-color: var(--main-bg-color);
      color: var(--text-color-dark);
      display: flex;
      min-height: 100vh;
      margin: 0;
    }

    .sidebar {
      width: 280px;
      background-color: var(--sidebar-bg-color);
      color: var(--text-color-light);
      padding: 40px 0px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: fixed;
      height: 100%;
    }

    .sidebar h2 {
      font-weight: 700;
      margin-bottom: 10px;
      letter-spacing: -1px;
    }
    
    .sidebar p {
      font-size: 0.9rem;
      color: var(--text-color-light);
      opacity: 0.7;
    }

    .sidebar-submenu a {
      display: block;
      width: 100%;
      color: #f8f9fa;
      text-decoration: none;
      padding: 10px 0 10px 52px;
      box-sizing: border-box;
      transition: background-color 0.2s ease;
    }

    .sidebar-submenu a:hover,
    .sidebar-submenu a.active {
      background-color: rgba(255, 255, 255, 0.25);
      font-weight: bold;
    }

    .main-content {
      margin-left: 280px;
      flex-grow: 1;
      padding: 40px;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
    }

    .menu-card {
      background-color: var(--card-bg-color);
      border-radius: 12px;
      border: 1px solid #e9ecef;
      box-shadow: var(--card-shadow);
      transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
      cursor: pointer;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 2rem;
    }

    .menu-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--card-hover-shadow);
      border-color: var(--primary-accent-color);
    }

    .menu-card-icon {
      width: 200px;
      height: 200px;
      margin-bottom: 1.5rem;
    }

    .menu-card .card-title {
      font-weight: 500;
      font-size: 1.25rem;
      color: var(--text-color-dark);
      margin-bottom: 0.5rem;
    }

    .menu-card .card-text {
      color: var(--text-color-muted);
      font-size: 0.95rem;
      line-height: 1.6;
    }

    @media (max-width: 992px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        height: auto;
        position: static;
        border-radius: 0;
        padding: 20px;
      }
      .main-content {
        margin-left: 0;
        padding: 20px;
      }
      .menu-grid {
        gap: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>운영실 출입관리</h2>
    <p>Access Management System</p>
    <div style="margin-top: 20px; font-size: 1.2rem; text-align: left; width: 100%;">
      <ul class="list-unstyled sidebar-submenu">
        <li><a href="/register.html">ㆍ출입 등록</a></li>
        <li><a href="/exit.html">ㆍ퇴실 등록</a></li>
        <li><a href="/verify.html">ㆍ책임자 확인</a></li>
        <li><a href="#" onclick="goToSettings()">ㆍ설정</a></li>
      </ul>    
    </div>      
  </div>

  <div class="main-content">
    <div class="menu-grid">
      <div class="menu-card" onclick="location.href='/register.html'">
        <img src="./assets/출입등록.png" alt="출입 등록 아이콘" class="menu-card-icon" onerror="this.style.display='none';">
        <h5 class="card-title">출입 등록</h5>
        <p class="card-text">외부인의 출입을 등록합니다.</p>
      </div>
      <div class="menu-card" onclick="location.href='/exit.html'">
        <img src="./assets/퇴실등록.png" alt="퇴실 등록 아이콘" class="menu-card-icon" onerror="this.style.display='none';">
        <h5 class="card-title">퇴실 등록</h5>
        <p class="card-text">출입자의 퇴실 정보를 입력합니다.</p>
      </div>
      <div class="menu-card" onclick="location.href='/verify.html'">
        <img src="./assets/책임자확인.png" alt="책임자 확인 아이콘" class="menu-card-icon" onerror="this.style.display='none';">
        <h5 class="card-title">책임자 확인</h5>
        <p class="card-text">사후 확인을 위한 책임자의 서명용 입니다.</p>
      </div>
      <div class="menu-card" onclick="goToSettings()">
        <img src="./assets/설정.png" alt="설정 아이콘" class="menu-card-icon" onerror="this.style.display='none';">
        <h5 class="card-title">설정</h5>
        <p class="card-text">백업, 인쇄 등 시스템 설정을 합니다.</p>
      </div>
    </div>
  </div>

  <script>
    async function goToSettings() {
      const enteredPassword = prompt('설정 페이지에 접근하려면 비밀번호를 입력하세요.');

      // 사용자가 '취소'를 누르거나 아무것도 입력하지 않은 경우 함수 종료
      if (!enteredPassword) {
        return;
      }

      try {
        // 서버의 /api/login 으로 비밀번호 확인 요청
        const response = await fetch('/api/login', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ password: enteredPassword }),
        });

        if (response.ok) {
          // 인증 성공 시, settings.html이 접근을 허용하도록 sessionStorage에 플래그 저장
          sessionStorage.setItem('settings_access_granted', 'true');
          // settings.html 페이지로 이동
          window.location.href = '/settings.html';
        } else {
          // 인증 실패 시 서버가 보낸 에러 메시지 표시
          const result = await response.json();
          alert(result.message || '인증에 실패했습니다.');
        }
      } catch (error) {
        console.error('로그인 요청 오류:', error);
        alert('서버와 통신 중 오류가 발생했습니다. 서버가 실행 중인지 확인해 주세요.');
      }
    }
  </script>

</body>
</html>